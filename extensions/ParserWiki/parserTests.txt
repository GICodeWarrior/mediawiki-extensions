# Tests for the ParseEngine using maintenance/parserTests.php
# Please make sure that the input parser XML is an exact duplicate of the test result

!!article 
Grammar:WikiGrammar1_0
!!text
<grammar><tag tag=";; grammar for WikiGrammar v1.0&#10;;; only one parseObject at base level for the start rule / root node&#10;&lt;"/><parseObject><assignment tag="grammar"><tag tag=" ["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="parseObject"/></parseObject><tag tag=" -&gt;"/><parseObject><reference tag="ruleList"/></parseObject><tag tag=" -&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern/><tag tag="/"/></reference></parseObject></sequence></parseObject><tag tag="]"/></assignment></parseObject><tag tag="&gt;"/><tag tag="&#10;;; ignore whitespace, comments lines starting in # and tags&#10;"/><rule tag="tag"><tag tag=" ="/><tag tag=" &lt;"/><parseObject><assignment tag="tag"><tag tag=" /"/><pattern tag="(?:\s+|;;[^\n]*)*~r"/><tag tag="/"/></assignment></parseObject><tag tag="&gt;"/></rule><tag tag="&#10;"/><rule tag="pattern"><tag tag=" ="/><tag tag=" ["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="\/"/><tag tag="/"/></reference></parseObject><tag tag=" &lt;"/><parseObject><assignment tag="pattern"><tag tag=" /"/><pattern tag="(?:[^\\\/]|\\.)*"/><tag tag="/"/></assignment></parseObject><tag tag="&gt;"/><tag tag=" &lt;"/><parseObject><assignment tag="tag"><tag tag=" /"/><pattern tag="\/"/><tag tag="/"/></assignment></parseObject><tag tag="&gt;"/></sequence></parseObject><tag tag="]"/></rule><tag tag="&#10;;; This works a lot like polymorphism -&gt; new feature&#10;"/><rule tag="parseObject"><tag tag=" ="/><tag tag=" ("/><parseObject><choice><tag tag="&#10;&#9;["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="-&gt;"/><tag tag="/"/></reference></parseObject><tag tag=" &lt;"/><parseObject><assignment tag="parseObject"><tag tag=" &lt;"/><parseObject><assignment tag="reference"><tag tag=" /"/><pattern tag="\w+"/><tag tag="/"/><tag tag=" ("/><parseObject><choice tag="?"><tag tag="["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="="/><tag tag="/"/></reference></parseObject><tag tag=" -&gt;"/><parseObject><reference tag="pattern"/></parseObject></sequence></parseObject><tag tag="]"/></choice></parseObject><tag tag=")"/></assignment></parseObject><tag tag="&gt;"/></assignment></parseObject><tag tag="&gt;"/></sequence></parseObject><tag tag="]"/><tag tag="&#10;&#9;["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="\("/><tag tag="/"/></reference></parseObject><tag tag=" &lt;"/><parseObject><assignment tag="parseObject"><tag tag=" &lt;"/><parseObject><assignment tag="choice"><tag tag=" /"/><pattern tag="\??"/><tag tag="/"/><tag tag=" -&gt;"/><parseObject><reference tag="objectList"/></parseObject></assignment></parseObject><tag tag="&gt;"/></assignment></parseObject><tag tag="&gt;"/><tag tag=" -&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="\)"/><tag tag="/"/></reference></parseObject></sequence></parseObject><tag tag="]"/><tag tag="&#10;&#9;["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="\["/><tag tag="/"/></reference></parseObject><tag tag=" &lt;"/><parseObject><assignment tag="parseObject"><tag tag=" &lt;"/><parseObject><assignment tag="sequence"><tag tag=" -&gt;"/><parseObject><reference tag="objectList"/></parseObject></assignment></parseObject><tag tag="&gt;"/></assignment></parseObject><tag tag="&gt;"/><tag tag=" -&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="\]"/><tag tag="/"/></reference></parseObject></sequence></parseObject><tag tag="]"/><tag tag="&#10;&#9;["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="$"/><tag tag="/"/></reference></parseObject><tag tag=" &lt;"/><parseObject><assignment tag="parseObject"><tag tag=" &lt;"/><parseObject><assignment tag="text"><tag tag=" ("/><parseObject><choice tag="?"><tag tag="-&gt;"/><parseObject><reference tag="parseObject"/></parseObject></choice></parseObject><tag tag=")"/></assignment></parseObject><tag tag="&gt;"/></assignment></parseObject><tag tag="&gt;"/><tag tag=" -&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="$"/><tag tag="/"/></reference></parseObject></sequence></parseObject><tag tag="]"/><tag tag="&#10;&#9;["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="&lt;"/><tag tag="/"/></reference></parseObject><tag tag=" &lt;"/><parseObject><assignment tag="parseObject"><tag tag=" &lt;"/><parseObject><assignment tag="assignment"><tag tag=" /"/><pattern tag="\w+"/><tag tag="/"/><tag tag=" ["/><parseObject><sequence><tag tag="&#10;&#9;&#9;("/><parseObject><choice tag="?"><tag tag="-&gt;"/><parseObject><reference tag="pattern"/></parseObject></choice></parseObject><tag tag=")"/><tag tag="&#10;&#9;&#9;("/><parseObject><choice tag="?"><tag tag="-&gt;"/><parseObject><reference tag="parseObject"/></parseObject></choice></parseObject><tag tag=")"/></sequence></parseObject><tag tag="&#10;&#9;]"/></assignment></parseObject><tag tag="&gt;"/></assignment></parseObject><tag tag="&gt;"/><tag tag=" -&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="&gt;"/><tag tag="/"/></reference></parseObject></sequence></parseObject><tag tag="]"/></choice></parseObject><tag tag="&#10;)"/></rule><tag tag="&#10;;; Lists work a lot like regEx +'s -&gt; syntactic sugar&#10;"/><rule tag="objectList"><tag tag=" ="/><tag tag=" ("/><parseObject><choice tag="?"><tag tag="["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="parseObject"/></parseObject><tag tag=" -&gt;"/><parseObject><reference tag="objectList"/></parseObject></sequence></parseObject><tag tag="]"/></choice></parseObject><tag tag=")"/></rule><tag tag="&#10;"/><rule tag="ruleList"><tag tag=" ="/><tag tag=" ("/><parseObject><choice tag="?"><tag tag="["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern/><tag tag="/"/></reference></parseObject><tag tag=" &lt;"/><parseObject><assignment tag="rule"><tag tag=" /"/><pattern tag="\w+"/><tag tag="/"/><tag tag=" ["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="="/><tag tag="/"/></reference></parseObject><tag tag=" -&gt;"/><parseObject><reference tag="parseObject"/></parseObject></sequence></parseObject><tag tag="]"/></assignment></parseObject><tag tag="&gt;"/><tag tag=" -&gt;"/><parseObject><reference tag="ruleList"/></parseObject></sequence></parseObject><tag tag="]"/></choice></parseObject><tag tag=")"/></rule><tag/></grammar>
!!endarticle

!! test
Generic Test
!! input
;; grammar for WikiGrammar v1.0
;; only one parseObject at base level for the start rule / root node
<grammar [->parseObject ->ruleList ->tag=//]>
;; ignore whitespace, comments lines starting in # and tags
tag = <tag /(?:\s+|;;[^\n]*)*~r/>
pattern = [->tag=/\// <pattern /(?:[^\\\/]|\\.)*/> <tag /\//>]
;; This works a lot like polymorphism -> new feature
parseObject = (
	[->tag=/->/ <parseObject <reference /\w+/ (?[->tag=/=/ ->pattern])>>]
	[->tag=/\(/ <parseObject <choice /\??/ ->objectList>> ->tag=/\)/]
	[->tag=/\[/ <parseObject <sequence ->objectList>> ->tag=/\]/]
	[->tag=/$/ <parseObject <text (?->parseObject)>> ->tag=/$/]
	[->tag=/</ <parseObject <assignment /\w+/ [
		(?->pattern)
		(?->parseObject)
	]>> ->tag=/>/]
)
;; Lists work a lot like regEx +'s -> syntactic sugar
objectList = (?[->parseObject ->objectList])
ruleList = (?[->tag=// <rule /\w+/ [->tag=/=/ ->parseObject]> ->ruleList])
!! result
<grammar><tag tag=";; grammar for WikiGrammar v1.0&#10;;; only one parseObject at base level for the start rule / root node&#10;&lt;"/><parseObject><assignment tag="grammar"><tag tag=" ["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="parseObject"/></parseObject><tag tag=" -&gt;"/><parseObject><reference tag="ruleList"/></parseObject><tag tag=" -&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern/><tag tag="/"/></reference></parseObject></sequence></parseObject><tag tag="]"/></assignment></parseObject><tag tag="&gt;"/><tag tag="&#10;;; ignore whitespace, comments lines starting in # and tags&#10;"/><rule tag="tag"><tag tag=" ="/><tag tag=" &lt;"/><parseObject><assignment tag="tag"><tag tag=" /"/><pattern tag="(?:\s+|;;[^\n]*)*~r"/><tag tag="/"/></assignment></parseObject><tag tag="&gt;"/></rule><tag tag="&#10;"/><rule tag="pattern"><tag tag=" ="/><tag tag=" ["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="\/"/><tag tag="/"/></reference></parseObject><tag tag=" &lt;"/><parseObject><assignment tag="pattern"><tag tag=" /"/><pattern tag="(?:[^\\\/]|\\.)*"/><tag tag="/"/></assignment></parseObject><tag tag="&gt;"/><tag tag=" &lt;"/><parseObject><assignment tag="tag"><tag tag=" /"/><pattern tag="\/"/><tag tag="/"/></assignment></parseObject><tag tag="&gt;"/></sequence></parseObject><tag tag="]"/></rule><tag tag="&#10;;; This works a lot like polymorphism -&gt; new feature&#10;"/><rule tag="parseObject"><tag tag=" ="/><tag tag=" ("/><parseObject><choice><tag tag="&#10;&#9;["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="-&gt;"/><tag tag="/"/></reference></parseObject><tag tag=" &lt;"/><parseObject><assignment tag="parseObject"><tag tag=" &lt;"/><parseObject><assignment tag="reference"><tag tag=" /"/><pattern tag="\w+"/><tag tag="/"/><tag tag=" ("/><parseObject><choice tag="?"><tag tag="["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="="/><tag tag="/"/></reference></parseObject><tag tag=" -&gt;"/><parseObject><reference tag="pattern"/></parseObject></sequence></parseObject><tag tag="]"/></choice></parseObject><tag tag=")"/></assignment></parseObject><tag tag="&gt;"/></assignment></parseObject><tag tag="&gt;"/></sequence></parseObject><tag tag="]"/><tag tag="&#10;&#9;["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="\("/><tag tag="/"/></reference></parseObject><tag tag=" &lt;"/><parseObject><assignment tag="parseObject"><tag tag=" &lt;"/><parseObject><assignment tag="choice"><tag tag=" /"/><pattern tag="\??"/><tag tag="/"/><tag tag=" -&gt;"/><parseObject><reference tag="objectList"/></parseObject></assignment></parseObject><tag tag="&gt;"/></assignment></parseObject><tag tag="&gt;"/><tag tag=" -&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="\)"/><tag tag="/"/></reference></parseObject></sequence></parseObject><tag tag="]"/><tag tag="&#10;&#9;["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="\["/><tag tag="/"/></reference></parseObject><tag tag=" &lt;"/><parseObject><assignment tag="parseObject"><tag tag=" &lt;"/><parseObject><assignment tag="sequence"><tag tag=" -&gt;"/><parseObject><reference tag="objectList"/></parseObject></assignment></parseObject><tag tag="&gt;"/></assignment></parseObject><tag tag="&gt;"/><tag tag=" -&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="\]"/><tag tag="/"/></reference></parseObject></sequence></parseObject><tag tag="]"/><tag tag="&#10;&#9;["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="$"/><tag tag="/"/></reference></parseObject><tag tag=" &lt;"/><parseObject><assignment tag="parseObject"><tag tag=" &lt;"/><parseObject><assignment tag="text"><tag tag=" ("/><parseObject><choice tag="?"><tag tag="-&gt;"/><parseObject><reference tag="parseObject"/></parseObject></choice></parseObject><tag tag=")"/></assignment></parseObject><tag tag="&gt;"/></assignment></parseObject><tag tag="&gt;"/><tag tag=" -&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="$"/><tag tag="/"/></reference></parseObject></sequence></parseObject><tag tag="]"/><tag tag="&#10;&#9;["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="&lt;"/><tag tag="/"/></reference></parseObject><tag tag=" &lt;"/><parseObject><assignment tag="parseObject"><tag tag=" &lt;"/><parseObject><assignment tag="assignment"><tag tag=" /"/><pattern tag="\w+"/><tag tag="/"/><tag tag=" ["/><parseObject><sequence><tag tag="&#10;&#9;&#9;("/><parseObject><choice tag="?"><tag tag="-&gt;"/><parseObject><reference tag="pattern"/></parseObject></choice></parseObject><tag tag=")"/><tag tag="&#10;&#9;&#9;("/><parseObject><choice tag="?"><tag tag="-&gt;"/><parseObject><reference tag="parseObject"/></parseObject></choice></parseObject><tag tag=")"/></sequence></parseObject><tag tag="&#10;&#9;]"/></assignment></parseObject><tag tag="&gt;"/></assignment></parseObject><tag tag="&gt;"/><tag tag=" -&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="&gt;"/><tag tag="/"/></reference></parseObject></sequence></parseObject><tag tag="]"/></choice></parseObject><tag tag="&#10;)"/></rule><tag tag="&#10;;; Lists work a lot like regEx +'s -&gt; syntactic sugar&#10;"/><rule tag="objectList"><tag tag=" ="/><tag tag=" ("/><parseObject><choice tag="?"><tag tag="["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="parseObject"/></parseObject><tag tag=" -&gt;"/><parseObject><reference tag="objectList"/></parseObject></sequence></parseObject><tag tag="]"/></choice></parseObject><tag tag=")"/></rule><tag tag="&#10;"/><rule tag="ruleList"><tag tag=" ="/><tag tag=" ("/><parseObject><choice tag="?"><tag tag="["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern/><tag tag="/"/></reference></parseObject><tag tag=" &lt;"/><parseObject><assignment tag="rule"><tag tag=" /"/><pattern tag="\w+"/><tag tag="/"/><tag tag=" ["/><parseObject><sequence><tag tag="-&gt;"/><parseObject><reference tag="tag"><tag tag="="/><tag tag="/"/><pattern tag="="/><tag tag="/"/></reference></parseObject><tag tag=" -&gt;"/><parseObject><reference tag="parseObject"/></parseObject></sequence></parseObject><tag tag="]"/></assignment></parseObject><tag tag="&gt;"/><tag tag=" -&gt;"/><parseObject><reference tag="ruleList"/></parseObject></sequence></parseObject><tag tag="]"/></choice></parseObject><tag tag=")"/></rule><tag/></grammar>

!! end

