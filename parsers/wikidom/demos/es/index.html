<!doctype html>

<html>
	<head>
		<title>EditSurface Demo</title>
		<link rel="stylesheet" href="../../lib/es/es.Surface.css">
		<style>
			body {
				font-family: "Arial";
				font-size: 1em;
				width: 100%;
				margin: 0;
				padding: 0;
				overflow-y: scroll;
				-webkit-user-select: none;
			}
			#es-toolbar,
			#es-editor {
				border: solid 1px silver;
				margin-left: 12.5%;
				margin-top: 1em;
				width: 75%;
			}
			.es-toolbarTool {
				float: left;
				width: 23px;
				height: 23px;
				margin: 0.5em 0 0.5em 0.5em;
			}
			.es-toolbarTool img {
				border: solid 1px white;
				cursor: pointer;
			}
			.es-toolbarTool img:hover {
				border-color: silver;
			}
		</style>
	</head>
	<body>
		<div id="es-toolbar" class="es-toolbar">
			<div class="es-toolbarTool" id="es-toolbar-bold"><img src="images/bold.png"></div>
			<div class="es-toolbarTool" id="es-toolbar-italic"><img src="images/italic.png"></div>
			<div class="es-toolbarTool" id="es-toolbar-link"><img src="images/link.png"></div>
			<div class="es-toolbarTool" id="es-toolbar-small"><img src="images/small.png"></div>
			<div class="es-toolbarTool" id="es-toolbar-big"><img src="images/big.png"></div>
			<div class="es-toolbarTool" id="es-toolbar-sub"><img src="images/sub.png"></div>
			<div class="es-toolbarTool" id="es-toolbar-super"><img src="images/super.png"></div>
			<div class="es-toolbarTool" id="es-toolbar-clear"><img src="images/clear.png"></div>
			<div style="clear:both"></div>
		</div>
		<div id="es-editor"></div>
		
		<!-- EditSurface -->
		<script type="text/javascript" src="../../lib/jquery.js"></script>
		<script type="text/javascript" src="../../lib/es/es.js"></script>
		<script type="text/javascript" src="../../lib/es/es.EventEmitter.js"></script>
		<script type="text/javascript" src="../../lib/es/es.Content.js"></script>
		<script type="text/javascript" src="../../lib/es/es.Container.js"></script>
		<script type="text/javascript" src="../../lib/es/es.Block.js"></script>
		<script type="text/javascript" src="../../lib/es/es.Document.js"></script>
		<script type="text/javascript" src="../../lib/es/es.Surface.js"></script>
		<script type="text/javascript" src="../../lib/es/es.TextFlow.js"></script>
		<script type="text/javascript" src="../../lib/es/es.ParagraphBlock.js"></script>
		<script type="text/javascript" src="../../lib/es/es.ListBlock.js"></script>
		<script type="text/javascript" src="../../lib/es/es.Cursor.js"></script>
		
		<!-- Demo -->
		<script>
			$(document).ready( function() {
				var doc = es.Document.newFromWikidom([
					{
						"type": "paragraph",
						"lines": [
							{
								'text': "In text display, line wrap is the feature of continuing on a new line when a line is full, such that each line fits in the viewable window, allowing text to be read from top to bottom without any horizontal scrolling.",
								'annotations': [
									// "In text display" should be bold
									{ 'type': 'bold', 'range': { 'start': 0, 'end': 15 } },
									// "line wrap" should be italic
									{ 'type': 'italic', 'range': { 'start': 17, 'end': 26 } },
									// "wrap is" should be a link to "#"
									{
										'type': 'link',
										'data': { 'href': './' },
										'range': { 'start': 22, 'end': 29 }
									},
								]
							},
							{ 'text': "Word wrap is the additional feature of most text editors, word processors, and web browsers, of breaking lines between and not within words, except when a single word is longer than a line." },
							{
								'text': "It is usually done on the fly when viewing or printing a document, so no line break code is manually entered, or stored.  If the user changes the margins, the editor will either automatically reposition the line breaks to ensure that all the text will \"flow\" within the margins and remain visible, or provide the typist some convenient way to reposition the line breaks.",
								'annotations': [
									// "[citation needed]" should be super
									{
										'type': 'template',
										'data': {
											'html': '<sup><small><a href="#">[citation needed]</a></small></sup>'
										},
										'range': { 'start': 120, 'end': 121 }
									}
								]
							},
							{ 'text': "A soft return is the break resulting from line wrap or word wrap, whereas a hard return is an intentional break, creating a new paragraph." },
						]
					},
					{
						'type': 'list',
						'style': 'number',
						'items': [
							{
								'line': { 'text': 'First item' },
								'lists': [
									{
										'type': 'list',
										'style': 'bullet',
										'items': [
											{ 'line': { 'text': 'First sub-item' } },
											{ 'line': { 'text': 'Second sub-item' } },
											{ 'line': { 'text': 'Third sub-item' } }
										]
									}
								]
							},
							{
								'line': {
									'text': 'Second item',
									'annotations': [
										{
											'type': 'italic',
											'range': {
												'start': 0,
												'end': 6
											}
										}
									]
								}
							},
							{
								'line': {
									'text': 'Third item',
									'annotations': [
										{
											'type': 'bold',
											'range': {
												'start': 0,
												'end': 5
											}
										}
									]
								}
							},
							{
								'line': {
									'text': 'Fourth item',
									'annotations': [
										{
											'type': 'link',
											'range': {
												'start': 7,
												'end': 11
											},
											'data': { 'title': 'User:JohnDoe' }
										}
									]
								}
							}
						]
					},
					{
						'type': 'paragraph',
						'lines': [
							{ 'text': 'The soft returns are usually placed after the ends of complete words, or after the punctuation that follows complete words. However, word wrap may also occur following a hyphen.' },
							{ 'text': 'Word wrap following hyphens is sometimes not desired, and can be avoided by using a so-called non-breaking hyphen instead of a regular hyphen. On the other hand, when using word processors, invisible hyphens, called soft hyphens, can also be inserted inside words so that word wrap can occur following the soft hyphens.' },
							{ 'text': 'Sometimes, word wrap is not desirable between words. In such cases, word wrap can usually be avoided by using a hard space or non-breaking space between the words, instead of regular spaces.' },
							{ 'text': 'OccasionallyThereAreWordsThatAreSoLongTheyExceedTheWidthOfTheLineAndEndUpWrappingBetweenMultipleLines.' },
							{ 'text': 'Text might have\ttabs\tin it too. Not all text will end in a line breaking character' }
						]
					}
				]);
				var surface = new es.Surface( $('#es-editor'), doc );
				
				$( '#es-toolbar .es-toolbarTool' ).mousedown( function( e ) {
					e.preventDefault();
					return false;
				} );
				$( '#es-toolbar-bold' ).click( function() {
						surface.annotateContent( 'toggle', { 'type': 'bold' } );
						return false;
					} );
				$( '#es-toolbar-italic' ).click( function() {
					surface.annotateContent( 'toggle', { 'type': 'italic' } );
					return false;
				} );
				$( '#es-toolbar-small' ).click( function() {
					surface.annotateContent( 'toggle', {
						'type': 'size',
						'data': { 'type': 'small' }
					} );
					return false;
				} );
				$( '#es-toolbar-big' ).click( function() {
					surface.annotateContent( 'toggle', {
						'type': 'size',
						'data': { 'type': 'big' }
					} );
					return false;
				} );
				$( '#es-toolbar-sub' ).click( function() {
					surface.annotateContent( 'toggle', {
						'type': 'script',
						'data': { 'type': 'sub' }
					} );
					return false;
				} );
				$( '#es-toolbar-super' ).click( function() {
					surface.annotateContent( 'toggle', {
						'type': 'script',
						'data': { 'type': 'super' }
					} );
					return false;
				} );
				$( '#es-toolbar-link' ).click( function() {
					surface.annotateContent( 'toggle', {
						'type': 'link',
						'data': { 'href': '#' }
					} );
					return false;
				} );
				$( '#es-toolbar-clear' ).click( function() {
					surface.annotateContent( 'remove', { 'type': 'all' } );
					return false;
				} );
			} );
		</script>
	</body>
</html>
