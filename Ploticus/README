SRF-Ploticus is a query printer for Semantic MediaWiki that uses
Ploticus to create plots, charts and graphics out of query results.

== Installation ==
The following should be installed and running.

1) Semantic MediaWiki
2) Ploticus 2.40 (http://ploticus.sourceforge.net)

When both of them are up and running, you can install this extension like
any other semantic result printer (refer to the separate README for that).

LocalSettings.php Modifications:
 * $srfgPloticusPath (default: /usr/bin/ploticus)
 
 * $srfgGDFontPath (default: '')
   - if you plan to use alternate TrueType fonts in your plot.
   (e.g. '/usr/share/fonts/truetype/freefont:/usr/share/fonts/truetype/msttcorefonts')

 * $wgEnableUploads (default: false - this is a MediaWiki setting)
   - must be true. Be sure the upload directory has the proper permissions.
   (see http://www.mediawiki.org/wiki/Manual:$wgUploadPath)

== Configuration and Usage ==
The SRF-ploticus Result Format has the following parameters:

 * ploticusmode (enum/optional)
   - set to 'prefab' (default) or 'script'
 
 * ploticusparams (string/required)
   - in prefab mode, this should be set to prefab cmdline parameters.
   Line endings can be used to split the prefab commandline for readability.
   
   In script mode, set to a ploticus script.  Line endings to separate directives
   can and should be used in script mode.  Otherwise, the ploticus script parser will fail.
        
 * imageformat (enum/optional)
   - png (default), gif, jpeg, svg, svgz, swf, wbmp, eps, ps, drawdump, drawdumpa.
   Availability of format depends on how ploticus is built.
        
 * alttext (string/optional)
   - alternate text displayed on mouseover. Ignored when client-side imagemap is generated.
 
 * showcsv (bool/optional)
   - 0 (default). When 1, displays link to CSV file used to generate plot.  Beware that the CSV
   ALWAYS shows the latest query result, which may sometimes fall out of sync with the "cached" plot.
   (See liveupdating, showtimestamp & updatefrequency parameters below)
 
 * debug (bool/optional)
   - 0 (default). When 1, displays ploticus prefab cmdline or script used to generate plot.
   Also turns showcsv on and bypasses the ploticus "cache".
        
 * liveupdating (bool/optional)
   - 1 (default). When 1, will check if the query result has changed and regenerate the plot based
   on the updatefrequency parameter.
   Otherwise, when 0, the plot will only be generated once and stored in the ploticus "cache".
   Its recommended to set showtimestamp to 1 when liveupdating is 0 or when updatefrequency > 0.

 * updatefrequency (secs/optional)
   - 60 (default). specifies how old a plot should be before its regenerated.  Only valid when
    liveupdating is 1.  If you do not want to "cache" the plot, set updatefrequency to 0.
    
 * showtimestamp (bool/optional)
   - 0 (default). Shows timestamp when the plot was last regenerated.
   
 * showrefresh (bool/optional)
   - 0 (default).  Shows a Refresh link to force refresh of the WHOLE article.


PREFAB MODE
===========
In prefab mode, ploticusparams expects commandline parameters that one would normally use when
invoking stand-alone ploticus in prefab mode.

However, the following prefab commandline parameters should NOT be specified:
 * data - automatically generated by the extension
 * output - automatically generated by the extension
 * format (e.g. -png, -gif, etc.) - use the SRF-ploticus imageformat parameter.
 
SCRIPT MODE
===========
In script mode, ploticusparams should be set to a ploticus script.

Two special keywords can be used in the script body (case-sensitive):
 * %DATAFILE.CSV% - replaced with fully qualified path to result CSV file generated by the inline query
 * %WORKINGDIR% - replaced with directory used by SRF-ploticus
 
For security reasons, the passed script is also "sanitized" and the following ploticus directives are disabled:
 * #include
 * #shell
 * #sql
 * #write
 * #cat

NOTE:
Client-side imagemaps are automatically generated by SRF-Ploticus if it detects the clickmap directive in
either prefab and script mode.
Typically, Imagemaps "links/labels" should be set to resolve to "Article URL/Article Name".

For up-to-date documentation and examples please refer to
http://semantic-mediawiki.org/wiki/Help:Ploticus_format
