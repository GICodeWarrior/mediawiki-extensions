--- php-5.1.1/ext/mime_magic/mime_magic.c	2005-10-19 01:04:07.000000000 +1000
+++ php5-5.1.1/ext/mime_magic/mime_magic.c	2005-12-20 19:25:24.000000000 +1100
@@ -494,7 +494,7 @@
 		} while (*(++p) != '/');
 		++p;
 		do {
-			if (!isalnum(*p) && (*p != '-') && (*p != '.') && !isspace(*p)) {
+			if (!isalnum(*p) && (*p != '-') && (*p != '.') && (*p != '+') && !isspace(*p)) {
 				return 0;
 			}
 		} while (*(++p));
@@ -627,6 +627,15 @@
     else if (strncmp(l, "string", NSTRING) == 0) {
 		m->type = STRING;
 		l += NSTRING;
+		if (*l == '/') {
+			++l;
+			if ((*l == 'B') || (*l == 'b') || (*l == 'c')) {
+				++l;
+				if ((*l == 'B') || (*l == 'b') || (*l == 'c')) {
+					++l;
+				}
+			}
+		}
     }
     else if (strncmp(l, "date", NDATE) == 0) {
 		m->type = DATE;
@@ -720,7 +729,7 @@
 	if (!is_valid_mimetype(l, strlen(l))) {
 		if(MIME_MAGIC_G(debug))
 			php_error_docref("http://www.php.net/mime_magic" TSRMLS_CC, E_WARNING, ": (%s:%d) '%s' is not a valid mimetype, entry skipped", MIME_MAGIC_G(magicfile), lineno, l);
-		return -1;
+		return 0;
 	}
 	
 	strncpy(m->desc, l, sizeof(m->desc) - 1);
