Description: fix arbitrary code execution via empty SQL query
Origin: upstream, http://svn.php.net/viewvc?view=revision&revision=298697

diff -Nur php5-5.2.4/ext/sqlite/sqlite.c php5-5.2.4.new/ext/sqlite/sqlite.c
--- php5-5.2.4/ext/sqlite/sqlite.c	2007-05-19 13:58:22.000000000 -0400
+++ php5-5.2.4.new/ext/sqlite/sqlite.c	2010-09-15 08:27:43.000000000 -0400
@@ -2170,7 +2170,7 @@
 		return;
 	}
 
-	rres = (struct php_sqlite_result *)emalloc(sizeof(*rres));
+	rres = (struct php_sqlite_result *)ecalloc(1, sizeof(*rres));
 	sqlite_query(NULL, db, sql, sql_len, (int)mode, 0, NULL, &rres, NULL TSRMLS_CC);
 	if (db->last_err_code != SQLITE_OK) {
 		if (rres) {
@@ -2286,7 +2286,7 @@
 		return;
 	}
 
-	rres = (struct php_sqlite_result *)emalloc(sizeof(*rres));
+	rres = (struct php_sqlite_result *)ecalloc(1, sizeof(*rres));
 	sqlite_query(NULL, db, sql, sql_len, PHPSQLITE_NUM, 0, NULL, &rres, NULL TSRMLS_CC);
 	if (db->last_err_code != SQLITE_OK) {
 		if (rres) {
