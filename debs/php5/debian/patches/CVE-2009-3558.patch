Description: fix open_basedir restrictions bypass via posix_mkfifo
upstream, Origin: http://svn.php.net/viewvc?view=revision&revision=288943

diff -Nur php5-5.2.4/ext/posix/posix.c php5-5.2.4.new/ext/posix/posix.c
--- php5-5.2.4/ext/posix/posix.c	2007-07-25 05:06:22.000000000 -0400
+++ php5-5.2.4.new/ext/posix/posix.c	2009-11-25 14:42:00.000000000 -0500
@@ -674,7 +674,8 @@
 		RETURN_FALSE;
 	}
 
-	if (PG(safe_mode) && (!php_checkuid(path, NULL, CHECKUID_ALLOW_ONLY_DIR))) {
+	if (php_check_open_basedir_ex(path, 0 TSRMLS_CC) ||
+			(PG(safe_mode) && (!php_checkuid(path, NULL, CHECKUID_ALLOW_ONLY_DIR)))) {
 		RETURN_FALSE;
 	}
 
