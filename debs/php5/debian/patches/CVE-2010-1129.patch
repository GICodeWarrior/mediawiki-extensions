Description: fix safe_mode bypass via trailing slash in dir pathnames
Origin: upstream, http://svn.php.net/viewvc?view=revision&revision=294882

diff -Nur php5-5.2.4/ext/standard/file.c php5-5.2.4.new/ext/standard/file.c
--- php5-5.2.4/ext/standard/file.c	2010-09-15 08:27:16.000000000 -0400
+++ php5-5.2.4.new/ext/standard/file.c	2010-09-15 08:27:19.000000000 -0400
@@ -815,7 +815,7 @@
 	convert_to_string_ex(arg1);
 	convert_to_string_ex(arg2);
 
-	if (PG(safe_mode) &&(!php_checkuid(Z_STRVAL_PP(arg1), NULL, CHECKUID_ALLOW_ONLY_DIR))) {
+	if (PG(safe_mode) &&(!php_checkuid(Z_STRVAL_PP(arg1), NULL, CHECKUID_CHECK_FILE_AND_DIR))) {
 		RETURN_FALSE;
 	}
 
