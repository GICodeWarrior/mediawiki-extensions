Description: fix safe_mode bypass via tempam function
upstream, Origin: http://svn.php.net/viewvc?view=revision&revision=288945

diff -Nur php5-5.2.4/ext/standard/file.c php5-5.2.4.new/ext/standard/file.c
--- php5-5.2.4/ext/standard/file.c	2009-11-25 14:41:44.000000000 -0500
+++ php5-5.2.4.new/ext/standard/file.c	2009-11-25 14:41:48.000000000 -0500
@@ -815,6 +815,10 @@
 	convert_to_string_ex(arg1);
 	convert_to_string_ex(arg2);
 
+	if (PG(safe_mode) &&(!php_checkuid(Z_STRVAL_PP(arg1), NULL, CHECKUID_ALLOW_ONLY_DIR))) {
+		RETURN_FALSE;
+	}
+
 	if (php_check_open_basedir(Z_STRVAL_PP(arg1) TSRMLS_CC)) {
 		RETURN_FALSE;
 	}
