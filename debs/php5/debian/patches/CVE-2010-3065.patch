Description: fix arbitrary session variable modification via crafted
 session variable name
Origin: upstream, http://svn.php.net/viewvc?view=revision&revision=298608

diff -Nur php5-5.2.4/ext/session/session.c php5-5.2.4.new/ext/session/session.c
--- php5-5.2.4/ext/session/session.c	2010-09-15 08:37:27.000000000 -0400
+++ php5-5.2.4.new/ext/session/session.c	2010-09-15 08:37:33.000000000 -0400
@@ -530,7 +530,7 @@
 
 	PS_ENCODE_LOOP(
 			smart_str_appendl(&buf, key, key_length);
-			if (memchr(key, PS_DELIMITER, key_length)) {
+			if (memchr(key, PS_DELIMITER, key_length) || memchr(key, PS_UNDEF_MARKER, key_length)) {
 				PHP_VAR_SERIALIZE_DESTROY(var_hash);
 				smart_str_free(&buf);				
 				return FAILURE;
