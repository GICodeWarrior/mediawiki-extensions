Description: fix file truncation via key with null byte
upstream, Origin: http://cvs.php.net/viewvc.cgi/php-src/ext/dba/libinifile/inifile.c?r1=1.14.2.1.2.4&r2=1.14.2.1.2.5
Bug-Debian: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=507101

diff -Nur php5-5.2.4/ext/dba/libinifile/inifile.c php5-5.2.4.new/ext/dba/libinifile/inifile.c
--- php5-5.2.4/ext/dba/libinifile/inifile.c	2007-01-01 14:40:29.000000000 -0500
+++ php5-5.2.4.new/ext/dba/libinifile/inifile.c	2009-11-25 14:41:12.000000000 -0500
@@ -508,7 +508,9 @@
 	
 	/* 5 */
 	if (ret == SUCCESS) {
-		ret = inifile_truncate(dba, append ? pos_grp_next : pos_grp_start TSRMLS_CC); /* writes error on fail */
+		if (!value || (key->name && strlen(key->name))) {
+			ret = inifile_truncate(dba, append ? pos_grp_next : pos_grp_start TSRMLS_CC); /* writes error on fail */
+		}
 	}
 
 	if (ret == SUCCESS) {
