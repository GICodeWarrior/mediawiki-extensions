Description: fix safe_mode bypass via semicolon in session_save_path
Origin: upstream, http://svn.php.net/viewvc?view=revision&revision=294272

diff -Nur php5-5.2.4/ext/session/session.c php5-5.2.4.new/ext/session/session.c
--- php5-5.2.4/ext/session/session.c	2010-09-15 08:27:26.000000000 -0400
+++ php5-5.2.4.new/ext/session/session.c	2010-09-15 08:27:30.000000000 -0400
@@ -158,8 +158,13 @@
 			return FAILURE;
 		}
 
-		if ((p = zend_memrchr(new_value, ';', new_value_length))) {
+		/* we do not use zend_memrchr() since path can contain ; itself */
+		if ((p = strchr(new_value, ';'))) {
+			char *p2;
 			p++;
+			if ((p2 = strchr(p, ';'))) {
+				p = p2 + 1;
+			}
 		} else {
 			p = new_value;
 		}
